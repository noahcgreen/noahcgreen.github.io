<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Disco Science IRL | Noah C. Green</title> <meta name="author" content="Noah C. Green"> <meta name="description" content="A physical counterpart to the Factorio Disco Science mod"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8E%B5&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://noahc.green/projects/disco_science_irl/"> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Noah </span>C. Green</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Disco Science IRL</h1> <p class="post-description">A physical counterpart to the Factorio Disco Science mod</p> </header> <article> <p><strong>The source code and STL files for this project are available on <a href="https://github.com/noahcgreen/Disco-Science-IRL" rel="external nofollow noopener" target="_blank">GitHub</a>.</strong></p> <p><a href="https://mods.factorio.com/mod/DiscoScience" rel="external nofollow noopener" target="_blank">Disco Science</a> is a great cosmetic Factorio mod that should really be included in the base game. It doesn’t impact gameplay in any way; all it does is change the “glow” color of active labs to reflect the ingredients that are being consumed by research. For example, the Speed Module technology consumes Automation (red) and Logistic (green) science packs, so while you’re researching that tech, your labs will flash red and green.</p> <p>Just for fun, and because LEDs are great, I decided to make a physical counterpart to the in-game Disco Science labs to accompany me while I play. It came out really nicely! The video below showcases it in use.</p> <div class="container"> <div style="text-align: center"> <iframe width="372" height="662" src="https://www.youtube.com/embed/7PQzcApEHyw" title="Disco Science IRL Demo" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe> </div> <div class="caption"> Disco Science IRL in action. When the researched tech is changed, the lab's colors change to match. </div> </div> <h2 id="reading-in-game-data-with-a-custom-mod">Reading In-Game Data With a Custom Mod</h2> <p>Disco Science colors labs to match the ingredients of the active research. I wanted to do the same for my physical component, so I needed to query the game for those ingredients somehow and deliver that information to my board. Fortunately, Factorio has incredible support for modding, and practically anything going on in the game can be picked up by a mod. I followed the approach of Disco Science to <a href="https://github.com/danielbrauer/DiscoScience/blob/master/src/core/researchColor.lua" rel="external nofollow noopener" target="_blank">read the ingredients of the tech being researched</a>. Then, I sent the ingredients from the in-game Lua runtime to a file via the <a href="https://lua-api.factorio.com/latest/LuaGameScript.html#LuaGameScript.write_file" rel="external nofollow noopener" target="_blank">write_file</a> API. It was surprisingly easy to do!</p> <p>There was one caveat I encountered. Unfortunately, there doesn’t seem to be a way for mods to react to the game being quit/shut down, which would ideally be an event that my mod could send outside of the runtime so the physical lab could turn itself off. To address this, I had my mod write to an additional file once per second. If that file hasn’t been touched in more than one second, then the game has ended. Or so I thought! I then found out that mods don’t run when the game is paused or when the tech tree is being viewed, so my mod would incorrectly make it appear as if the game had ended during those times. However, I’m completely fine with that because research does not actually progress at those times, so it’s consistent for my lab to turn itself off then.</p> <p>It does make sense that there is no “on game end/pause/etc.” event for mods to hook into, since a poorly written or malicious mod could delay shutdown and hurt the user’s experience.</p> <h2 id="the-driver">The Driver</h2> <p>The next step was to create a driver which would watch the files written by the mod and forward the ingredients to the board as they come. Reading the files was straightforward; most of the effort here went into managing the computer-board connection. I used the third-party <a href="https://pyserial.readthedocs.io/en/latest/pyserial.html" rel="external nofollow noopener" target="_blank">PySerial</a> Python package for this task. I also used <a href="http://py2exe.org" rel="external nofollow noopener" target="_blank">py2exe</a> to generate an executable from the driver. I did this because I wanted the driver to run at all times without me starting it manually from the command line. Once the executable was made, I copied a shortcut to it into my Windows startup folder. Now it runs automatically when I log in.</p> <h2 id="the-board">The Board</h2> <p>I started developing this project with an Arduino Nano, but I ended up switching to an <a href="https://www.adafruit.com/product/659" rel="external nofollow noopener" target="_blank">Adafruit Flora</a>. It was the perfect choice since it has USB-serial conversion and an addressable NeoPixel onboard, meaning I didn’t need to solder any additional components. That meant I could prototype very easily and will be able to remove the board cleanly when I want to repurpose it. On top of that, the small circular form factor meant it would fit easily into my 3D-printed enclosure.</p> <p>The enclosure itself is based on this <a href="https://www.thingiverse.com/thing:3240916" rel="external nofollow noopener" target="_blank">lab keycap</a> I found on Thingiverse. I used Fusion 360 to hollow out the inside and add a bottom piece for the Flora, then printed the pieces in transparent PETG. If I had the experience or willingness, I might have painted the gray lines onto the lab to make it a bit more accurate, but I didn’t feel the need to this time.</p> <div class="container"> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/disco-science-irl/parts1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/disco-science-irl/parts1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/disco-science-irl/parts1-1400.webp"></source> <img src="/assets/img/disco-science-irl/parts1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/disco-science-irl/parts2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/disco-science-irl/parts2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/disco-science-irl/parts2-1400.webp"></source> <img src="/assets/img/disco-science-irl/parts2.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/disco-science-irl/parts3-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/disco-science-irl/parts3-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/disco-science-irl/parts3-1400.webp"></source> <img src="/assets/img/disco-science-irl/parts3.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/disco-science-irl/parts4-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/disco-science-irl/parts4-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/disco-science-irl/parts4-1400.webp"></source> <img src="/assets/img/disco-science-irl/parts4.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Parts, assembly, and activation! </div> </div> </article> </div> </div> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>